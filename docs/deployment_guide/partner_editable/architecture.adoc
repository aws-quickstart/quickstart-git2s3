:xrefstyle: short

Deploying this AWS Solution with default parameters builds the following {partner-product-short-name} environment in the
AWS Cloud.

// Replace this example diagram with your own. Follow our wiki guidelines: https://w.amazon.com/bin/view/AWS_Quick_Starts/Process_for_PSAs/#HPrepareyourarchitecturediagram. Upload your source PowerPoint file to the GitHub {deployment name}/docs/images/ directory in its repository.

[#architecture_diagram]
.Solution architecture for {partner-product-short-name} on AWS
[link=images/architecture_diagram.png]
image::../docs/deployment_guide/images/architecture_diagram.png[architecture_diagram,width=100%,height=100%]

As shown in <<architecture_diagram>>, this solution sets up the following:

* Amazon API Gateway to receive Git webhook requests and forward them to AWS Lambda.
* An AWS Lambda function to process Git webhook requests from API Gateway and invoke an AWS CodeBuild project.
* An AWS CodeBuild project to connect to your Git service, then retrieve, zip, and upload the latest version of your Git repository to Amazon S3.
* An AWS Key Management Service (AWS KMS) key to encrypt/decrypt the SSH (Secure Shell) keys used by AWS CodeBuild to connect to your Git repository using SSH. The SSH key pair is generated by a Lambda-backed AWS CloudFormation custom resource when the stack is deployed.
* Two Amazon S3 buckets: one for Git repository contents, and another for encrypted SSH keys. A Lambda-backed AWS CloudFormation custom resource deletes the contents of the S3 buckets when you delete the CloudFormation stack. If you need backups, copy the S3 buckets before deleting the stack.

[.small]#* The template that deploys this Partner Solution into an existing VPC skips the components marked by asterisks and prompts you for your existing VPC configuration.#

[NOTE]
========
* The solution deploys AWS Identity and Access Management (IAM) roles required by Lambda and API Gateway. The inline permissions attached to the roles are scoped using the least-privilege model. For more information, refer to http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege[Apply least-privilege permissions^].
* The AWS CodeBuild project must be able to communicate with your Git repository. For example, you can employ a SaaS-based Git service like GitHub to which CodeBuild can connect over the internet.
* The Git repository S3 bucket this solution deploys has versioning enabled, and all previous versions are retained indefinitely. To modify the retention period, see http://docs.aws.amazon.com/AmazonS3/latest/user-guide/create-lifecycle.html[How do I create a lifecycle rule for an S3 bucket?^]
========